# 海量日志处理架构设计

## 业务难点

- 多源：来自于不同的终端与传感器
- 异构：结构不统一、字段不统一、维度不一致
- 海量：每天上百亿级条
- 实时：秒级延迟，并实时关联分析
- 可定制化：多条业务线，业务领域不同，查询视角不同
- 非标硬件：多种硬件型号与部署形态

## 解决方案

### 统一的数据模型与数据标准

- 提高数据治理水平，从安全视角统一行业名称与字段语义
- 提高数据模型的抽象层次，减少表的数量
  
### 插件式可扩展的ETL引擎

- 支持多种采集方式：主动/被动
- 支持多种采集协议：kafka/syslog/http/snmp
- 支持多种日志匹配规则
- 可编排日志处理流程(解析、富化、转换、外发、入库)
- 支持本地、分布式部署模式、

### 自研的高性能存储引擎

- 同等资源占用下，写入性能是ES的2倍，查询性能与ES持平
- 支持全文检索
- 兼容ES的DSL语法
- 支持水平扩展，分片与副本，支持PB级数据的存储

### 流式实时分析引擎

- 关联分析引擎
- 支持过滤、序列、统计、关联、基线、情报、不发生等多种规则

### 统一的集成与配置方案

- 全容器化部署，由k8s统一调度在线/离线引擎任务，ETL/分析引擎
- 预制基本型号的资源控制模版
- 使用operator统一且简化参数调整流程

### 产品交互设计方案

- 统计数据需主动触发
- 非关键数据延迟加载
- 可自定义产品的数据标准
- 可后台配置页面展示的表与字段

### 全方位的监控告警

- 全链路延迟监控
- 数据质量+数据流监控
- 硬件、系统、中间件、业务多维度监控