# 插件框架

## 关键技术点

- 定义清晰的接口和规范：每个插件应该遵循一组预定义的接口和规范, 定义插件的基本行为和功能，例如初始化、执行任务、处理错误等
- 插件的生命周期管理：例如安装、卸载、启动、停止等阶段。框架应该为这些阶段提供相应的钩子或回调函数，以便插件可以执行特定的操作
- 提供插件注册和管理机制：包括加载和卸载插件、启用和禁用插件、查看插件的状态和元数据等
- 保持插件的独立性和隔离性：每个插件应该作为一个独立的模块运行，不应该直接访问或影响其他插件的内部状态。
- 提供通用服务和工具：提供通用的服务和工具，以便插件可以利用。这可能包括日志服务、配置管理、数据访问接口等
- 错误处理和容错：框架应该能够处理插件的错误，并提供适当的容错机制。例如，如果一个插件崩溃，框架应该能够记录错误信息，并尝试恢复或重新启动插件
- 支持插件的热插拔：可以在不重启整个系统的情况下添加、删除或更新插件
- 插件的配置和自定义：提供一种用户友好的方式来编辑插件的配置文件，或者提供API来动态地修改插件的行为

## 分类

插件是一些包含了定制化业务逻辑、扩展功能、附加功能的独立组件，用于扩充核心系统的功能

- 编译时插件: 通过命名或namespace实现
- 运行时插件: 通常以动态库的形式、比如.jar, .so, .dll等
- 远端插件: 通常以远程服务的形式，比如RESTful API, WebSocket, gRPC等, 插件和核心系统不必使用相同的技术栈，只需遵守既定的REST接口即可

插件中心包括：所有插件的基本信息，名称、数据契约，通信协议、加载地址等

- 通信方式: 本地接口调用、REST、RPC、消息队列等
- 交互行为: 插件对核心系统提供的接口，比如本地的函数/方法等
- 数据格式: 通常是类和结构体

## 设计思想

微内核的设计思想，能够极大提升系统的可扩展性和健壮性
领域驱动设计中，领域层相当于核心系统，定义了系统的核心业务逻辑，基础设施层相当于插件，切换不同的基础设施并不会影响业务系统的业务逻辑，得益于基础设施层依赖倒置的设计原则